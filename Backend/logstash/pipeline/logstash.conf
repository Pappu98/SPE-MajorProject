# logstash.conf

# Input section: Where Logstash will collect logs from
input {
  beats {
    port => 5044
  }
}

# Filter section: How Logstash processes the logs
filter {
  # Example of a grok filter to parse common log formats
  grok {
    match => { "message" => "%{COMBINEDAPACHELOG}" }
  }

  # Example of a date filter to parse timestamps
  date {
    match => [ "timestamp", "dd/MMM/yyyy:HH:mm:ss Z" ]
    target => "@timestamp"
  }

  # Example of adding fields or tags
  mutate {
    add_field => { "custom_field" => "custom_value" }
  }

  # Example of filtering specific log levels
  if [loglevel] == "ERROR" {
    mutate {
      add_tag => ["error"]
    }
  }
}

# Output section: Where Logstash sends the processed logs
output {
  # Output to Elasticsearch
  elasticsearch {
    hosts => ["http://elasticsearch:9200"]
    index => "logstash-%{+YYYY.MM.dd}"
  }

  # Output to a file
  file {
    path => "/var/log/logstash/logs.txt"
  }

  # Output to stdout (for debugging)
  stdout {
    codec => rubydebug
  }
}